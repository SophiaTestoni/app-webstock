<header class="header">
  <h1 class="title">PAINEL DE GESTÃO DE RESERVAS</h1>
</header>

<div class="formulario">
  <form #a="ngForm" (submit)="cadastrar(a.value)" class="formulario">
    <mat-card>
      <mat-card-header class="title_center">
        <mat-card-title>CADASTRO</mat-card-title>
      </mat-card-header>
      <mat-card-content class="card-content">
        <div class="row">
          <div class="col-sm-3">
            <mat-label>ID Item:</mat-label>
            <br>
            <mat-form-field>
              <input matInput ngModel name="idItem" placeholder="Ex.: 1500" id="idItem" step="1" min="1" />
            </mat-form-field>
          </div>
          <div class="col-sm-3">
            <mat-label>Qtde:</mat-label>
            <br>
            <mat-form-field>
              <input matInput placeholder="Ex.: 10" ngModel name="quantidadeReserva" id="idOrigem"
                [disabled]="disableCtrl" />
            </mat-form-field>
          </div>
          <div class="col-sm-3">
            <mat-label>Data:</mat-label>
            <br>
            <mat-form-field>
              <input matInput [matDatepicker]="picker" ngModel name="dataPrevista" placeholder="MM/DD/YYYY">
              <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
              <mat-datepicker #picker></mat-datepicker>
            </mat-form-field>
          </div>
          <div class="col-sm-3">
            <mat-label>Ordem:</mat-label>
            <mat-form-field>
              <input matInput placeholder="Ex.: PO1234" ngModel name="ordem" id="ordem" [disabled]="disableCtrl" />
            </mat-form-field>
          </div>
        </div>

        <div class="row">
          <div class="sol-sm-3">
            <mat-card-actions>
              <button mat-raised-button class="button-salvar-color">Salvar</button>
            </mat-card-actions>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </form>
</div>

<div class="formulario">
  <app-reserva-atualizar [expectedProp]="book"></app-reserva-atualizar>
</div>

<mat-card class="table">
  <mat-card-content>
    <mat-table [dataSource]="dataSource" matSort>

      <!-- ID Column -->
      <ng-container matColumnDef="id">
        <mat-header-cell *matHeaderCellDef mat-sort-header> ID </mat-header-cell>
        <mat-cell *matCellDef="let r" data-label="id"> {{r.idReserva}} </mat-cell>
      </ng-container>

      <!-- Data Column -->
      <ng-container matColumnDef="data">
        <mat-header-cell *matHeaderCellDef mat-sort-header> Data prevista </mat-header-cell>
        <mat-cell *matCellDef="let r" data-label="data"> {{r.dataPrevista}} </mat-cell>
      </ng-container>

      <!-- Ordem Column -->
      <ng-container matColumnDef="ordem">
        <mat-header-cell *matHeaderCellDef mat-sort-header> Ordem </mat-header-cell>
        <mat-cell *matCellDef="let r" data-label="ordem"> {{r.ordem}} </mat-cell>
      </ng-container>

      <!-- Quantidade Column -->
      <ng-container matColumnDef="quantidade">
        <mat-header-cell *matHeaderCellDef mat-sort-header> Quantidade </mat-header-cell>
        <mat-cell *matCellDef="let r" data-label="quantidade"> {{r.quantidadeReserva}} </mat-cell>
      </ng-container>

      <!-- Finalizada Column -->
      <ng-container matColumnDef="finalizada">
        <mat-header-cell *matHeaderCellDef mat-sort-header> Finalizada </mat-header-cell>
        <mat-cell *matCellDef="let r" data-label="finalizada"> <mat-icon *ngIf="r.finalizada" title="Finalizada">done</mat-icon> 
          <mat-icon *ngIf="!r.finalizada" title="Não Finalizada">watch_later</mat-icon> </mat-cell>
      </ng-container>

      <!-- Item Column -->
      <ng-container matColumnDef="item">
        <mat-header-cell *matHeaderCellDef mat-sort-header> Item </mat-header-cell>
        <mat-cell *matCellDef="let r" data-label="item"> {{r.item.descricao}} </mat-cell>
      </ng-container>

      <!-- ID Item Column -->
      <ng-container matColumnDef="idItem">
        <mat-header-cell *matHeaderCellDef mat-sort-header> ID Item </mat-header-cell>
        <mat-cell *matCellDef="let r" data-label="idItem"> {{r.item.idItem}} </mat-cell>
      </ng-container>

      <!-- Usuário Column -->
      <ng-container matColumnDef="usuario">
        <mat-header-cell *matHeaderCellDef mat-sort-header> Usuário </mat-header-cell>
        <mat-cell *matCellDef="let r" data-label="usuario"> {{r.usuario.nome}} </mat-cell>
      </ng-container>

      <!-- Editar Column -->
      <ng-container matColumnDef="editar">
        <mat-header-cell *matHeaderCellDef mat-sort-header> Editar </mat-header-cell>
        <mat-cell *matCellDef="let r" data-label="editar"> <mat-icon *ngIf="!r.finalizada" title="Editar"
              (click)="escrever(r, r.item.idItem)">edit</mat-icon>
          <mat-icon *ngIf="r.finalizada">edit</mat-icon></mat-cell>
      </ng-container>

      <!-- Excluir Column -->
      <ng-container matColumnDef="excluir">
        <mat-header-cell *matHeaderCellDef mat-sort-header> Excluir </mat-header-cell>
        <mat-cell *matCellDef="let r" data-label="excluir"> <button class="btn btn-outline-danger mt-3"
            (click)="dataSource.excluir(r.idReserva)"
            [disabled]="(r.finalizada==false)? false:true">Apagar</button></mat-cell>
      </ng-container>

      <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
      <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>
    </mat-table>
    <mat-paginator #paginator [pageSizeOptions]="[4, 8, 10]" aria-label="Select page" showFirstLastButtons>
    </mat-paginator>
